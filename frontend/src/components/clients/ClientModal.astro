---
---

<div
    x-data={`{
    show: false,
    formData: {
        name: '',
        email: '',
        phoneNumber: '',
        curp: '',
        status: 'REGISTRO_PENDIENTE',
    },
    loading: false,

    get botId() {
        return new URLSearchParams(window.location.search).get('id') || '';
    },

    async submit() {
        this.loading = true;
        try {
            const payload = { ...this.formData, botId: this.botId };
            await ApiClient.post('/clients', payload);
            window.location.reload();
        } catch (e) {
            console.error(e);
            alert('Error: ' + e.message);
        } finally {
            this.loading = false;
        }
    },

    open() {
        this.formData = {
            name: '',
            email: '',
            phoneNumber: '',
            curp: '',
            status: 'REGISTRO_PENDIENTE',
        };
        this.show = true;
    }
}`}
>
    <!-- Trigger Button -->
    <button
        @click="open()"
        class="px-6 py-2 bg-brand-purple text-white font-mono uppercase text-xs tracking-widest hover:bg-brand-purple/80 transition-colors flex items-center gap-2 rounded-full"
    >
        <span>+</span>
        <span>Nuevo Cliente</span>
    </button>

    <!-- Modal -->
    <div
        x-show="show"
        x-transition.opacity
        class="fixed inset-0 z-50 flex items-center justify-center p-4"
        style="display: none;"
    >
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" @click="show = false"></div>

        <div class="relative bg-brand-dark border border-white/10 p-8 w-full max-w-lg max-h-[90vh] overflow-y-auto shadow-2xl">
            <div class="cross-marker -top-[2px] -left-[2px]"></div>
            <div class="cross-marker -top-[2px] -right-[2px]"></div>
            <div class="cross-marker -bottom-[2px] -left-[2px]"></div>
            <div class="cross-marker -bottom-[2px] -right-[2px]"></div>

            <h2 class="text-xl font-bold uppercase tracking-tight mb-6 flex justify-between items-center">
                <span>Nuevo Cliente</span>
                <button @click="show = false" class="text-gray-500 hover:text-white">&times;</button>
            </h2>

            <div class="space-y-5">
                <!-- Name -->
                <div>
                    <label class="block text-xs text-gray-400 font-mono uppercase mb-2">Nombre Completo</label>
                    <input type="text" x-model="formData.name"
                        class="w-full bg-black/30 border border-white/10 p-3 text-sm focus:border-brand-purple focus:outline-none text-white placeholder-gray-600"
                        placeholder="Nombre completo" />
                </div>

                <!-- CURP -->
                <div>
                    <label class="block text-xs text-gray-400 font-mono uppercase mb-2">CURP</label>
                    <input type="text" x-model="formData.curp" maxlength="18"
                        class="w-full bg-black/30 border border-white/10 p-3 text-sm focus:border-brand-purple focus:outline-none text-white placeholder-gray-600 font-mono uppercase"
                        placeholder="CURP (18 caracteres)" />
                </div>

                <!-- Email + Phone -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs text-gray-400 font-mono uppercase mb-2">Email</label>
                        <input type="email" x-model="formData.email"
                            class="w-full bg-black/30 border border-white/10 p-3 text-sm focus:border-brand-purple focus:outline-none text-white placeholder-gray-600" />
                    </div>
                    <div>
                        <label class="block text-xs text-gray-400 font-mono uppercase mb-2">Tel√©fono</label>
                        <input type="text" x-model="formData.phoneNumber"
                            class="w-full bg-black/30 border border-white/10 p-3 text-sm focus:border-brand-purple focus:outline-none text-white placeholder-gray-600"
                            placeholder="521..." />
                    </div>
                </div>

                <!-- Status -->
                <div>
                    <label class="block text-xs text-gray-400 font-mono uppercase mb-2">Estatus</label>
                    <select x-model="formData.status"
                        class="w-full bg-black/30 border border-white/10 p-3 text-sm focus:border-brand-purple focus:outline-none text-white">
                        <option value="REGISTRO_PENDIENTE">Registro Pendiente</option>
                        <option value="PAGO_GOBIERNO_PENDIENTE">Pago Gobierno Pendiente</option>
                        <option value="PAGO_GOBIERNO_REALIZADO">Pago Gobierno Realizado</option>
                        <option value="EXAMEN_EN_PROCESO">Examen en Proceso</option>
                        <option value="LICENCIA_LISTA">Licencia Lista</option>
                        <option value="COMPLETADO">Completado</option>
                    </select>
                </div>
            </div>

            <!-- Actions -->
            <div class="flex gap-4 pt-6 mt-6 border-t border-white/5">
                <button type="button" @click="show = false"
                    class="flex-1 px-4 py-3 border border-white/10 text-gray-400 font-mono uppercase text-xs hover:bg-white/5 transition-colors">
                    Cancelar
                </button>
                <button type="button" @click="submit()" :disabled="loading"
                    class="flex-1 px-4 py-3 bg-brand-purple text-white font-mono uppercase text-xs hover:bg-brand-purple/80 disabled:opacity-50 transition-colors"
                    x-text="loading ? 'Guardando...' : 'Guardar'">
                </button>
            </div>
        </div>
    </div>
</div>
